# 견적 시스템 추가 개선 사항 가이드

## 🎯 우선순위별 수정 항목

### ✅ 완료된 항목

1. **설정 모달 개선**
   - 고정 메시지 입력 필드 추가
   - 직인 이미지 업로드 기능 추가
   - UI 개선 (섹션 구분, 아이콘 추가)

2. **보기 버튼 위치 수정**
   - 미리보기 컬럼으로 분리 완료

3. **미리보기 모달 기능**
   - JavaScript 함수 정리
   - 모든 액션 버튼 기능 추가

### 🔄 진행 중인 항목

#### 1. 규격 입력을 2칸으로 분리 (가로 x 세로)
**위치**: admin_quote.php의 품목 입력 폼

**수정 방법**:
```html
<!-- 기존 -->
<input type="text" name="qi_spec[]" placeholder="450×450(mm)">

<!-- 변경 후 -->
<div class="flex gap-2 items-center">
    <input type="number" name="qi_spec_w[]" placeholder="가로" class="w-full">
    <span>×</span>
    <input type="number" name="qi_spec_h[]" placeholder="세로" class="w-full">
</div>
```

**JavaScript 수정 필요**:
- `add_item_row()` 함수에서 2개 입력 필드 생성
- 폼 submit 시 "가로×세로" 형식으로 합치기

#### 2. 이미지 붙여넣기 기능
**구현 방법**:
```javascript
// 이미지 업로드 영역에 paste 이벤트 추가
document.addEventListener('paste', function(e) {
    var items = e.clipboardData.items;
    for (var i = 0; i < items.length; i++) {
        if (items[i].type.indexOf('image') !== -1) {
            var blob = items[i].getAsFile();
            // FormData로 변환하여 업로드
            // 또는 임시로 미리보기 표시 후 폼 submit시 함께 전송
        }
    }
});
```

#### 3. 전화번호 자동 포맷팅
**구현 위치**: 연락처 입력 필드

```javascript
function formatPhoneNumber(input) {
    var numbers = input.value.replace(/[^0-9]/g, '');
    var formatted = '';
    
    if (numbers.startsWith('02')) {
        // 서울 지역번호
        if (numbers.length < 3) {
            formatted = numbers;
        } else if (numbers.length < 6) {
            formatted = numbers.slice(0, 2) + '-' + numbers.slice(2);
        } else if (numbers.length < 10) {
            formatted = numbers.slice(0, 2) + '-' + numbers.slice(2, 5) + '-' + numbers.slice(5);
        } else {
            formatted = numbers.slice(0, 2) + '-' + numbers.slice(2, 6) + '-' + numbers.slice(6, 10);
        }
    } else if (numbers.startsWith('01')) {
        // 휴대폰
        if (numbers.length < 4) {
            formatted = numbers;
        } else if (numbers.length < 8) {
            formatted = numbers.slice(0, 3) + '-' + numbers.slice(3);
        } else {
            formatted = numbers.slice(0, 3) + '-' + numbers.slice(3, 7) + '-' + numbers.slice(7, 11);
        }
    } else {
        // 기타 지역번호
        if (numbers.length < 4) {
            formatted = numbers;
        } else if (numbers.length < 7) {
            formatted = numbers.slice(0, 3) + '-' + numbers.slice(3);
        } else if (numbers.length < 11) {
            formatted = numbers.slice(0, 3) + '-' + numbers.slice(3, 6) + '-' + numbers.slice(6);
        } else {
            formatted = numbers.slice(0, 3) + '-' + numbers.slice(3, 7) + '-' + numbers.slice(7, 11);
        }
    }
    
    input.value = formatted;
}

// 적용
<input type="tel" onkeyup="formatPhoneNumber(this)" ...>
```

#### 4. 필수 항목 변경 (이메일 → 연락처)
**수정 파일**: admin_quote.php

```html
<!-- 이메일 필드에서 required 제거 -->
<input type="email" name="qa_client_email" ...>

<!-- 연락처 필드에 required 추가 -->
<input type="tel" name="qa_client_hp" required ...>
```

#### 5. 주소 검색 기능
Daum 우편번호 API 사용:
```html
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script>
function execDaumPostcode() {
    new daum.Postcode({
        oncomplete: function(data) {
            document.getElementById('qa_client_addr').value = data.address;
            document.getElementById('qa_client_addr2').focus();
        }
    }).open();
}
</script>
```

### 📋 추가 기능 구현 필요 항목

#### 6. 연도 자동 생성 확인
현재 코드 확인 결과:
```php
<select name="f_year" id="f_year" ...>
    <?php for ($y = date('Y'); $y >= date('Y') - 5; $y--): ?>
        <option value="<?php echo $y; ?>" ...>
    <?php endfor; ?>
</select>
```
**현황**: 현재 연도부터 5년 전까지만 표시
**개선**: 현재 연도 + 5년 미래까지 표시하도록 변경

```php
<?php for ($y = date('Y') + 5; $y >= date('Y') - 5; $y--): ?>
```

#### 7. 목록에 추가 정보 표시
**추가할 정보**:
- 품목 수량 (몇 개 항목)
- 최종 수정일시
- 이메일 발송 여부
- 상태 아이콘

#### 8. 게시물 요약 팝업
**구현 방법**:
- 각 행에 아이콘 버튼 추가 (ℹ️)
- 클릭 시 작은 모달 표시
- 표시 내용: 품목 목록, 총 금액, 메모 등

#### 9. 상태 커스터마이징
**구현 방법**:
1. 설정에 "상태 목록 관리" 섹션 추가
2. 사용자가 상태명과 색상 지정 가능
3. quote_config.json에 상태 배열 저장

```json
{
  "custom_statuses": [
    {"name": "작성중", "color": "yellow"},
    {"name": "견적발송", "color": "blue"},
    {"name": "연락두절", "color": "red"},
    {"name": "계약완료", "color": "green"}
  ]
}
```

#### 10. 견적서 디자인 개선 (quote_view.php)
**개선 사항**:
- 고정 메시지 표시 영역 추가
- 직인 이미지 표시 (우측 하단)
- 그라데이션 배경
- 더 명확한 섹션 구분
- 인쇄 시 최적화

#### 11. 배달완료 버튼 제거
**간단한 수정**:
```html
<!-- quote_view.php에서 해당 버튼 제거 -->
<button onclick="alert('배달완료 기능은 관리자 페이지에서 사용 가능합니다.')" ...>
    <span>✓</span> 배달완료
</button>
```

#### 12. 미리보기 버튼 중복 제거
**문제**: 미리보기 모달 내부와 외부에 버튼이 중복 표시됨
**해결**: quote_view.php의 하단 버튼 바에 조건문 추가

```php
<?php if (!isset($_GET['preview']) || $_GET['preview'] != '1'): ?>
    <!-- 버튼 표시 -->
<?php endif; ?>
```

그리고 모달에서 호출 시:
```javascript
var url = './quote_view.php?qa_id=' + qa_id + '&preview=1&_ts=' + ts;
```

## 🎨 전체 디자인 개선 제안

### 색상 팔레트 통일
```css
:root {
    --primary: #ea580c;      /* 오렌지 */
    --primary-dark: #c2410c;
    --secondary: #374151;     /* 다크 그레이 */
    --success: #10b981;       /* 그린 */
    --warning: #f59e0b;       /* 옐로우 */
    --danger: #ef4444;        /* 레드 */
    --info: #3b82f6;          /* 블루 */
}
```

### 일관된 버튼 스타일
```html
<!-- Primary -->
<button class="bg-orange-600 hover:bg-orange-700 text-white ...">

<!-- Secondary -->
<button class="bg-gray-200 hover:bg-gray-300 text-gray-700 ...">

<!-- Success -->
<button class="bg-green-600 hover:bg-green-700 text-white ...">
```

### 그림자와 간격 통일
```css
.card {
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    border-radius: 0.75rem;
    padding: 1.5rem;
}
```

## 📝 구현 우선순위 권장

1. **높은 우선순위** (사용성 직접 영향)
   - 전화번호 자동 포맷팅
   - 필수 항목 변경
   - 주소 검색 기능 복구
   - 규격 2칸 분리

2. **중간 우선순위** (편의성)
   - 이미지 붙여넣기
   - 상태 커스터마이징
   - 목록 정보 추가

3. **낮은 우선순위** (미관)
   - 디자인 개선
   - 요약 팝업
   - 애니메이션 효과

## ⚠️ 주의사항

1. **백업 필수**: 모든 수정 전 반드시 원본 파일 백업
2. **단계별 테스트**: 각 기능 추가 후 즉시 테스트
3. **브라우저 캐시**: 수정 후 Ctrl+F5로 캐시 클리어
4. **모바일 테스트**: 반응형 동작 확인
5. **데이터베이스**: 스키마 변경 시 백업 후 진행

## 🚀 다음 단계

요청하신 모든 기능을 구현하려면 상당한 시간이 필요합니다. 
어떤 기능부터 우선적으로 구현할지 알려주시면, 
해당 기능에 집중하여 완전한 코드를 제공하겠습니다.

가장 필요한 기능 3가지만 선택해주시면 완벽하게 구현해드리겠습니다!
